var allnotselected = `(
SELECT rider_participation_id, account_participation_id FROM team_selection_rider
INNER JOIN account_participation USING(account_participation_id )
WHERE race_id = 6 AND budgetparticipation = false
EXCEPT
SELECT rider_participation_id, account_participation_id FROM stage_selection_rider 
INNER JOIN stage_selection USING(stage_selection_id)
INNER JOIN account_participation USING(account_participation_id)
WHERE stage_id = ${stage_id} AND budgetparticipation = false
) a`
var allselectedriders = `(SELECT rider_participation_id FROM stage_selection_rider 
INNER JOIN stage_selection USING(stage_selection_id)
INNER JOIN account_participation USING(account_participation_id)
WHERE stage_id = ${stage_id} AND budgetparticipation = false
GROUP BY rider_participation_id)`
var stage_id = `182`


SELECT username, ARRAY_AGG(lastname) FROM ${allnotselected}
INNER JOIN account_participation USING(account_participation_id)
INNER JOIN account USING(account_id)
INNER JOIN rider_participation USING(rider_participation_id)
INNER JOIN rider USING(rider_id)
WHERE rider_participation_id in ${allselectedriders}
GROUP BY username